<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Andy Field" />


<meta name="progressive" content="true" />
<meta name="allow-skip" content="false" />

<title>AAiR: Repeated-measures designs</title>


<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<div id="section-an-adventure-in-r-repeated-measures-designs-part-1" class="section level1">
<h1>An Adventure in R: Repeated-measures designs (part 1)</h1>
<div id="section-overview" class="section level2">
<h2>Overview</h2>
<p>This tutorial is one of a series that accompanies <a href="https://www.discoveringstatistics.com/books/an-adventure-in-statistics/">An Adventure in Statistics</a> <span class="citation">(A. P. Field 2016)</span> and <a href="https://www.discoveringstatistics.com/books/discovering-statistics-using-r/">Discovering Statistics Using R</a> <span class="citation">(A. P. Field, Miles, and Field 2012)</span> by <a href="https://en.wikipedia.org/wiki/Andy_Field_(academic)">me</a>. These tutorials contain abridged sections from the book so there are some copyright considerations but I offer them under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>,<a href="#section-fn1" class="footnoteRef" id="section-fnref1"><sup>1</sup></a></p>
<ul>
<li>Who is the tutorial aimed at?
<ul>
<li>Primarily students enrolled on my <em>Linear models in statistics</em> module at the University of Sussex, but anyone teaching from or reading <a href="https://www.discoveringstatistics.com/books/an-adventure-in-statistics/">An Adventure in Statistics</a> or <a href="https://www.discoveringstatistics.com/books/discovering-statistics-using-r/">Discovering Statistics Using R</a> <span class="citation">(A. P. Field, Miles, and Field 2012)</span> may find them useful.</li>
</ul></li>
<li>What is covered?
<ul>
<li>This tutorial looks at how to fit a linear model with a predictor variable that represents two dependent categories. We look at robust variants of the model, and computing a Bayes factor. It would be a useful tutorial to run alongside teaching based on Chapter 15 of <a href="https://www.discoveringstatistics.com/books/an-adventure-in-statistics/">An Adventure in Statistics</a>.</li>
<li>This tutorial <em>does not</em> teach the background theory: it is assumed you have either attended my lecture or read the relevant chapter in the aforementioned books (or someone else’s)</li>
<li>The aim of this tutorial is to augment the theory that you already know by guiding you through fitting linear models using <strong>R</strong> and <strong>RStudio</strong> and asking you questions to test your knowledge along the way.</li>
</ul></li>
</ul>
</div>
<div id="section-story-precis" class="section level2">
<h2>Story précis</h2>
<div id="section-why-a-precis" class="section level3">
<h3>Why a précis?</h3>
<p>Because these tutorials accompany my book <em>An adventure in statistics</em>, which uses a fictional narrative to teach the statistics, some of the examples might not make sense unless you know something about the story. For those of you who don’t have the book I begin each tutorial with a précis of the story. If you’re not interested then fair enough - click past this section.</p>
</div>
<div id="section-general-context-for-the-story" class="section level3">
<h3>General context for the story</h3>
<p>It is the future. Zach, a rock musician and Alice, a geneticist, who have been together since high school live together in Elpis, the ‘City of Hope’.</p>
<p>Zach and Alice were born in the wake of the Reality Revolution which occurred after a Professor Milton Gray invented the Reality Prism – a transparent pyramid worn on the head – that brought honesty to the world. Propaganda and media spin became unsustainable, religions collapsed, advertising failed. Society could no longer be lied to. Everyone could know the truth about anything that they could look at. A gift, some said, to a previously self-interested, self-obsessed society in which the collective good had been eroded.</p>
<p>But also a curse. For, it soon became apparent that through this Reality Prism, people could no longer kid themselves about their own puffed-up selves as they could see what they were really like – by and large, pretty ordinary. And this caused mass depression. People lost faith in themselves. Artists abandoned their pursuits, believing they were untalented and worthless.</p>
<p>Zach and Alice have never worn a Reality Prism and have no concept of their limitations. They were born after the World Governance Agency (WGA) destroyed all Reality Prisms, along with many other pre-revolution technologies, with the aim of restoring community and well-being. However, this has not been straightforward and in this post-Prism world, society has split into pretty much two factions</p>
<ul>
<li>The Chippers who have had WiFi-enabled chips implanted into their brains, enabling them to record and broadcast what they see and think in real time; upload memories for future generations into a newly-created memoryBank and live-stream music and films directly into their brains.</li>
<li>The Clocktarians, followers of the old pre-Prism ways who use steam punk style technologies, who have elected not to have chips in their brains, regarded by the Chippers as backward-looking stuck in a ‘clockwork, Victorian society’.</li>
</ul>
<p>Everyone has a star, a limitless space on which to store their digital world.</p>
<p>Zach and Alice are Clocktarians. Their technology consists mainly of:</p>
<ul>
<li>A Proteus, a device made from programmable matter that can transform shape and function simply by the owners’ wishes. Zach calls his a diePad, in the shape of a tombstone in an ironic reference to an over-reliance on technology at the expense of memory.</li>
<li>A Reality Checker, a clockwork mechanism that, at the point of critical velocity, projects an opaque human head that is linked to everything and can tell you anything. Every head has a personality and Zach’s is a handsome, laid back ‘dude’ who is like an electronic friend, who answers questions if he feels like it and often winds Zach up by giving him false information. And he often flirts with Alice.</li>
</ul>
</div>
<div id="section-main-protagonists" class="section level3">
<h3>Main Protagonists</h3>
<ul>
<li>Zach
<ul>
<li>Rock musician in band called The Reality Enigma.</li>
<li>Spellbinding performer, has huge fan-base.</li>
<li>Only people living in Elpis get to see The Reality Enigma in the flesh. Otherwise all performances are done via an oculus riff, a multisensory headset for experiencing virtual gigs.</li>
<li>Zach’s music has influenced and changed thousands of lives.</li>
<li>Wishes he had lived pre-Revolutionary times, the turn of the 21st Century, a golden age for music when bands performed in reality at festivals.</li>
<li>Kind, gentle and self-doubting.</li>
<li>Believes science and maths are dull and uninspiring. Creates a problem between him and Alice as she thinks that because he isn’t interested in science, he isn’t interested in her. Leads to lots of misunderstandings between them.</li>
</ul></li>
<li>Alice
<ul>
<li>Shy, lonely, academically-gifted – estranged from the social world until she met Zach in the college library.</li>
<li>Serious scientist, works at the Beimeni Centre of Genetics.</li>
<li>At 21, won the World Science Federation’s Einstein Medal for her genetics research</li>
<li>Desperately wants Zach to get over his fear of science so he can open his mind to the beauty of it.</li>
</ul></li>
</ul>
</div>
<div id="section-how-zachs-adventure-begins" class="section level3">
<h3>How Zach’s adventure begins</h3>
<p>Alice has been acting strangely, on edge for weeks, disconnected and uncommunicative, as if she is hiding something and Zach can’t get through to her. Arriving home from band practice, unusually, she already home and listening to an old album that the two of them enjoyed together, back in a simpler, less complicated time in their relationship. During an increasingly testy evening, that involves a discussion with the Head about whether or not a Proteus causes brain cancer, Alice is interrupted by an urgent call which she takes in private. She returns looking worried and is once again, distracted. She tells Zach that she has ‘a big decision to make’. Before going to bed, Zach asks her if he can help with the decision but she says he ‘already has’, thanking him for making ‘everything easier.’ He has no idea what she means and goes to sleep, uneasy.</p>
<p>On waking, Zach senses that something is wrong. And he is right. Alice has disappeared. Her clothes, her possessions and every photo of them together have gone. He can’t get hold of any of her family or friends as their contact information is stored on her Proteus, not on his diePad. He manages to contact the Beimeni Centre but is told that no one by the name of Alice Nightingale has ever worked there. He logs into their constellation but her star has gone. He calls her but finds that her number never existed. She has, thinks Zach, been ‘wiped from the planet.’ He summons The Head but he can’t find her either. He tells Zach that there are three possibilities: Alice has doesn’t want to be found, someone else doesn’t want her to be found or she never existed.</p>
<p>Zach calls his friend Nick, fellow band member and fan of the WGA-installed Repositories, vast underground repositories of actual film, books, art and music. Nick is a Chipper – solely for the purpose of promoting the band using memoryBank – and he puts the word out to their fans about Alice missing.</p>
<p>Thinking as hard as he can, Zach recalls the lyrics of the song she’d been playing the previous evening. Maybe they are significant? It may well be a farewell message and the Head is right. In searching for clues, he comes across a ‘memory stone’ which tells him to read what’s on there. File 1 is a research paper that Zach can’t fathom. It’s written in the ‘language of science’ and the Head offers to help Zach translate it and tells him that it looks like the results of her current work were ‘gonna blow the world’. Zach resolves to do ‘something sensible’ with the report.</p>
<p>Zach doesn’t want to believe that Alice has simply just left him. Rather, that someone has taken her and tried to erase her from the world. He decides to find her therapist, Dr Murali Genari and get Alice’s file. As he breaks into his office, Dr Genari comes up behind him and demands to know what he is doing. He is shaking but not with rage – with fear of Zach. Dr Genari turns out to be friendly and invites Zach to talk to him. Together they explore the possibilities of where Alice might have gone and the likelihood, rating her relationship satisfaction, that she has left him. During their discussion Zach is interrupted by a message on his diePad from someone called Milton. Zach is baffled as to who he is and how he knows that he is currently discussing reverse scoring. Out of the corner of his eye, he spots a ginger cat jumping down from the window ledge outside. The counsellor has to go but suggests that Zach and ‘his new friend Milton’ could try and work things out.</p>
</div>
</div>
<div id="section-packages-and-data" class="section level2">
<h2>Packages and data</h2>
<div id="section-packages" class="section level3">
<h3>Packages</h3>
<p>This tutorial uses the following packages:</p>
<ul>
<li><code>BayesFactor</code> <span class="citation">(Morey and Rouder 2014)</span> to compute Bayes factors</li>
<li><code>gmodels</code> <span class="citation">(Warnes et al. 2015)</span> to compute confidence intervals</li>
<li><code>nlme</code> <span class="citation">(Pinheiro et al. 2017)</span> to estimate the multilevel models</li>
<li><code>tidyverse</code> <span class="citation">(Wickham 2017)</span> for general data processing</li>
<li><code>WRS2</code> <span class="citation">(Mair, Schoenbrodt, and Wilcox 2017)</span> to do various robust tests</li>
</ul>
<p>These packages are automatically loaded within this tutorial. If you are working outside of this tutorial (i.e. in <strong>RStudio</strong>) then you need to make sure that the package has been installed by executing <code>install.packages(&quot;package_name&quot;)</code>, where <em>package_name</em> is the name of the package. If the package is already installed, then you need to reference it in your current session by executing <code>library(package_name)</code>, where <em>package_name</em> is the name of the package.</p>
</div>
<div id="section-data" class="section level3">
<h3>Data</h3>
<p>This tutorial has the data files pre-loaded so you shouldn’t need to do anything to access the data from within the tutorial. However, if you want to play around with what you have learnt in this tutorial outside of the tutorial environment (i.e. in a stand-alone <strong>RStudio</strong> session) you will need to download the data files and then read them into your <strong>R</strong> session. This tutorial uses the following file:</p>
<ul>
<li><a href="http://www.discoveringstatistics.com/repository/ais_data/ais_15_calcite.csv">ais_15_calcite.csv</a>.</li>
</ul>
<p>You can load the file in several ways:</p>
<ul>
<li>Assuming that you save this file into the working directory, you can load it by executing:
<ul>
<li><code>calcite_dat &lt;- read_csv(&quot;ais_15_calcite.csv&quot;)</code></li>
<li>If you save the file somewhere other than the working directory, you will need to specify the file location (see the tutorial called <em>adventr_02</em>)</li>
</ul></li>
<li>To load the file using a standard dialogue box to navigate your file system, execute:
<ul>
<li><code>calcite_dat &lt;- read_csv(file.choose())</code></li>
</ul></li>
<li>You can load the file direct from the URL (i.e., you don’t need to download it first) by executing:
<ul>
<li><code>calcite_dat &lt;- read_csv(&quot;http://www.discoveringstatistics.com/repository/ais_data/ais_15_calcite.csv&quot;)</code></li>
<li>This method relies on an internet connection (and my server having not exploded!)</li>
</ul></li>
</ul>
</div>
</div>
<div id="section-categorical-predictors-with-repeated-measures" class="section level2">
<h2>Categorical predictors with repeated measures</h2>
<div id="section-the-model" class="section level3">
<h3>The model</h3>
<p>During Zach’s visit to the JIG:SAW complex he visits several research buildings. In the first, he discovers experiments being conducted related to invisibility. The second experiment he learns about involves a repeated-measures design. The researchers asked the question of whether they could manipulate the face perceived by a participant when viewing someone wearing calcite invisibility paste. Participants were all so-called Chippers, who had ID chips installed in their brains. Each participant met 40 people who had calcite paste on their face. For each of these people we took a photo of their face (the ‘actual’ face), and found a photo of a different face matched for sex and age (the ‘different’ face). The researchers could send these images to the participant’s visual cortex using their ID chip. For 20 of the encounters an image of the person’s ‘actual’ face was transmitted to the participant’s ID chip during the encounter, for the remaining 20 encounters the ‘different’ face was sent to the chip. As such the design was repeated measures (each participant experienced both the ‘actual’ and ‘different’ conditions). During each encounter the participant was shown the photos of the actual and different face and pointed to the one depicting whom they thought they were meeting. Participants scored a point for each person they correctly identified: a score of 0 would mean that they never chose the correct photo, a score of 20 would mean that they always chose the correct photo. The prediction was that the paste would lead to lower recognition when a different face (inconsistent information) was transmitted to the visual cortex than when the actual face (consistent information) was transmitted. The data are in the tibble <code>calcite_dat</code>, which has three variables:</p>
<ul>
<li><strong>id</strong>: Participant ID</li>
<li><strong>actual</strong>: How many of the 20 people the participant correctly identified when a picture of the ‘actual’ person was transmitted to the participant’s ID chip</li>
<li><strong>different</strong>: How many of the 20 people the participant correctly identified when a picture of a ‘different’ person was transmitted to the participant’s ID chip</li>
</ul>
<p>The data has a hierarchical structure because recognition scores are nested within participants (Figure 1). We, therefore, need to model the individual differences in recognition scores (random intercept) and the effect of the type of face (random slopes).</p>
<div class="figure">
<img src="images/ais_calcite_paste_data_hierarchy_small.png" alt="Figure 1: The structure of the calcite paste data" />
<p class="caption">Figure 1: The structure of the calcite paste data</p>
</div>
<p>The model we’re fitting is described by the following equation:</p>
<p><span class="math display">\[
\begin{aligned}
\text{recognition}_{ij} &amp; = b_{0i} + b_{1i}\text{face type}_{ij}+ ε_{ij}\\
b_{0i} &amp;= b_0 + u_{0i}\\
b_{1i} &amp;= b_1 + u_{1i}
\end{aligned}
\]</span></p>
<p>Recognition scores within participants (<em>i</em>) and experimental treatments (<em>j</em>) are predicted from overall recognition scores (<span class="math inline">\(b_0\)</span>) and participant’s variation around it (<span class="math inline">\(u_0i\)</span>), the overall effect of the type of face (<span class="math inline">\(b_1\)</span>) and participant’s variation around that effect (<span class="math inline">\(u_{1i}\)</span>), and some error (<span class="math inline">\(ε_{ij}\)</span>). In other words, it is a multilevel model with random intercepts and slopes for the effect of face type.</p>
</div>
<div id="section-making-data-tidy" class="section level3">
<h3>Making data ‘tidy’</h3>
<p>Use the code box to inspect the <code>calcite_dat</code> tibble.</p>
<div class="tutorial-exercise" data-label="inspect_dat" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="inspect_dat-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>calcite_dat   </code></pre>
</div>
<p>The data are organised in what is known as the <em>wide format</em>. In this format, each row represents a different entity and columns represent different scores belonging to that entity. For example, row 1 belongs to participant 1, column 2 tells us that they recognized 12 faces when a photo of the <em>actual</em> face was transmitted to their ID chip and column 3 tells us that they recognized 6 faces when a photo of a <em>different</em> face was transmitted to their ID chip. As such, the variable representing the type of face is split across two columns. The <em>wide format</em> is very common, but is <em>messy</em>, and usually we want the data to <em>tidy</em>. Although there is a lot more to it than this, pragmatically, <span class="citation">Wickham (2014)</span> distinguished <em>tidy</em> and <em>messy</em> data structures as follows:</p>
<blockquote>
<p>A dataset is messy or tidy depending on how rows, columns and tables are matched up with observations, variables and types. In tidy data:</p>
<ol style="list-style-type: decimal">
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ol>
<p>… Messy data is any other arrangement of the data.</p>
</blockquote>
<p>To make our data ‘tidy’ we can use the <code>gather()</code> function from the <code>tidyverse</code> suite of packages. This function gathers columns together and puts them into a single column (across multiple rows). It takes the form:</p>
<p><code>gather(data, key = &quot;name_of_column_containing_variable_information&quot;, value = &quot;name_of_column_containing_values&quot;)</code></p>
<p>Basically, you enter the name of the tibble that you want to restructure. It will stack all of the values from the columns into a single column with the name that you provide in the <code>value</code> argument, and it will list the original column names in a variable with the name that you provide in the <code>key</code> argument. If you ignore the <code>key</code> and <code>value</code> arguments the function will use the names <strong>key</strong> and <strong>value</strong>. To get a feel for what happens, try executing:</p>
<p><code>gather(calcite_dat)</code></p>
<p>in the code box below.</p>
<p>Our initial tibble had 20 rows (one for each participant) and 3 columns (<strong>id</strong>, <strong>actual</strong>, <strong>different</strong>). You’ll see that the restructured tibble has 60 rows (3 for each participant) and 2 columns (one containing the original column names, and one containing the values associated with each participant for the three original columns).</p>
<p>This structure isn’t helpful to us because it has gathered <em>all</em> of the original columns, and we need it to gather only the <strong>actual</strong> and <strong>different</strong> columns leaving the <strong>id</strong> column alone (because this column tells us to which participant a score belongs). We can tell the function to leave the <strong>id</strong> column alone by using a minus sign (<code>-id</code>). We should also define the <code>key</code> and <code>value</code> names. We might call the <em>key</em> variable <strong>face_type</strong>, because it will represent whether the face beamed to the ID chip was the actual face or a different one, and the <em>value</em> variable <strong>recognition</strong> because it contains recognition scores (out of 20). Putting all of this together we could execute:</p>
<p><code>gather(calcite_dat, key = &quot;face_type&quot;, value = &quot;recognition&quot;, -id)</code></p>
<p>Try this command is the code box. The resulting tibble should have 40 rows (each of 20 participants under each of the two conditions) and three columns (<strong>id</strong> tells us the participant number, <strong>face_type</strong> defines the experimental condition, and <strong>recognition</strong> contains the recognition score for each participant in each experimental condition). These data are tidy. So we can use this restructured tibble we need to save it into an object. Let’s call it <code>calcite_tidy</code>. We can do this by either placing the original tibble into the <code>gather()</code> function:</p>
<p><code>calcite_tidy &lt;- gather(calcite_dat, key = &quot;face_type&quot;, value = &quot;recognition&quot;, -id)</code></p>
<p>or by using a pipe:</p>
<p><code>calcite_tidy &lt;- calcite_dat %&gt;% gather(key = &quot;face_type&quot;, value = &quot;recognition&quot;, -id)</code></p>
<p>Execute one of these commands in the code box, and then inspect the resulting tibble.</p>
<div class="tutorial-exercise" data-label="gather_dat" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="gather_dat-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>calcite_tidy &lt;- calcite_dat %&gt;% gather(key = &quot;face_type&quot;, value = &quot;recognition&quot;, -id)
calcite_tidy</code></pre>
</div>
</div>
<div id="section-descriptive-data" class="section level3">
<h3>Descriptive data</h3>
<p>Use what you’ve learnt in previous tutorials to create a tibble called <code>calcite_summary</code> containing the mean recognition scores (and their confidence intervals) in the two experimental conditions.</p>
<p><font color='#009E73'>Tip: Remember to use the tidy tibble that we’ve just created. If you’re doing this outside of the tutorial remember to load the packages tidyverse and gmodels</font></p>
<div class="tutorial-exercise" data-label="desc" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="6">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="desc-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>calcite_summary &lt;- calcite_tidy %&gt;% group_by(face_type) %&gt;% summarize(
  mean_recognition = mean(recognition),
  ci_low_recognition = ci(recognition)[&quot;CI lower&quot;],
  ci_upp_recognition = ci(recognition)[&quot;CI upper&quot;]
)
calcite_summary              </code></pre>
</div>
</div>
<div id="section-plotting-the-data" class="section level3">
<h3>Plotting the data</h3>
<p>Use the code box below to create an error bar chart with <strong>face_type</strong> on the <em>x</em>-axis and <strong>recognition</strong> on the <em>y</em>-axis. If you feel like it, try to superimpose the raw data. (If you do this last part you’ll use the <code>geom_point()</code> function, try this, but then add into the function <code>position = position_jitter(width = 0.1, height = 0)</code>. This adds what’s known as a ‘jitter’ to the points, which just means that small a random value is added so that the dots don’t overlap. By setting width to 0.1, we’re limiting the horizontal jitter and disabling the horizontal jitter so that the values on the <em>y</em>-axis are true to the actual scores.) Remember to use the ‘tidy’ version of the data.</p>
<div class="tutorial-exercise" data-label="scat" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="8">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="scat-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>calcite_plot &lt;- ggplot(calcite_tidy, aes(face_type, recognition))
calcite_plot +
  geom_point(colour = &quot;#E69F00&quot;, position = position_jitter(width = 0.1, height = 0)) +
  stat_summary(fun.data = &quot;mean_cl_normal&quot;, geom = &quot;pointrange&quot;) +
  labs(x = &quot;Experimental condition&quot;, y = &quot;Recoognition (out of 20&quot;) +
  coord_cartesian(ylim = c(0, 20)) +
  scale_y_continuous(breaks = 0:20) +
  scale_x_discrete(labels = c(&quot;Actual face&quot;, &quot;Different face&quot;)) + #adds more descriptive labels to the x-axis
  theme_bw()</code></pre>
</div>
</div>
</div>
<div id="section-fitting-the-model" class="section level2">
<h2>Fitting the model</h2>
<p>It looks like recognition scores are lower in the <em>different</em> condition. To fit the model we use the <code>lme()</code> function, because we are fitting a linear model with a categorical predictor, but we want to also model the dependency between scores. This function is explained in the tutorial <strong>adventr_mlm</strong>, just to recap it takes the following general form (I’ve retained only the key options):</p>
<p><code>new_object &lt;- lme(outcome ~ predictors, random = formula, data = tibble, method = &quot;REML&quot;, na.action = na.fail)</code></p>
<ul>
<li><code>new_model</code>: an object created that contains information about the model. We can get summary statistics for this model by executing the name of the model.</li>
<li><code>outcome</code>: the variable that contains the scores for the outcome measure (in this case <strong>recognition</strong>).</li>
<li><code>predictor</code>: the variable that contains information about to which condition a score belongs (in this case <strong>face_type</strong>).</li>
<li><code>random</code>: defines the random parts of the model. This takes a formula in the style <code>~ predictor|context</code>. In this case our context is participants, which is represented by the variable <strong>id</strong>. If we want only to let intercepts vary by participant we could use <code>~ 1|id</code>, but in fact we also want to let the effect of <strong>face_type</strong> vary by participant so we’d use <code>~ face_type|id</code>.</li>
<li><code>tibble</code>: the name of the tibble containing the data (in this case <code>calcite_tidy</code>).</li>
<li><code>method</code>: defines which estimation method is used. By default restricted maximum likelihood is used (REML), but if you want to compare models you should override the default and use maximum likelihood (<code>method = &quot;ML&quot;</code>).</li>
<li><code>na.action</code>: If you have complete data (as we have here) exclude this option, but if you have missing values (i.e., ‘NA’s in the data frame) then by default the model will fail, so include <code>na.action = na.exclude</code> to exclude cases with missing values.</li>
</ul>
<p>We could, therefore, specify the model as:</p>
<pre class="r"><code>calcite_rs &lt;- lme(recognition ~ face_type, random = ~ face_type|id, data = calcite_tidy, method = &quot;ML&quot;)
summary(calcite_rs)
intervals(calcite_rs, which = &quot;fixed&quot;)</code></pre>
<p>The first line creates an object called <code>calcite_rs</code> which predicts recognition scores from the effect of <strong>face_type</strong> but with intercepts and slopes allowed to vary across participants (I appended <code>_rs</code> to the name to remind me it is a <em>r</em>andom <em>s</em>lopes model). The <code>summary()</code> function gives me a summary of the model (including a <em>t</em>-statistic and <em>p</em>-value for the fixed effect of <strong>face_type</strong>) and <code>intervals()</code> gives me 95% confidence intervals for the fixed effects (hence the <code>which = &quot;fixed&quot;</code>), which in this case are the intercept and effect of <strong>face_type</strong>.</p>
<p>Try executing these commands in the code box.</p>
<div class="tutorial-exercise" data-label="lme_1" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="lme_1-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>calcite_rs &lt;- lme(recognition ~ face_type, random = ~ face_type|id, data = calcite_tidy, method = &quot;ML&quot;)
summary(calcite_rs)
intervals(calcite_rs, which = &quot;fixed&quot;)</code></pre>
</div>
<p>The output provides estimates of the model parameters (the <em>b</em>-values) and the significance of these values. The <em>Y</em> intercept (<span class="math inline">\(b_0\)</span>) is 9.20, which is the value of recognition when <strong>face_type</strong> = 0. <strong>R</strong> will have coded the variable <strong>face_type</strong> using dummy coding. It will do this alphabetically (unless you tell it something different), which means that it will have coded ‘actual’ as 0 and ‘different’ as 1 (because <em>a</em> comes before <em>d</em> in the alphabet). Note that 9.20 is the value of the mean in the <em>actual</em> condition that we calculated earlier.</p>
<div class="panel panel-default">
<div class="panel-heading tutorial-panel-heading">Quiz</div>
<table class="table quiz-table">
<tr>
<td>

<div id="htmlwidget-d8670fca86eea0f0c4d6" style="width:100%;height:auto;", class = "quiz html-widget">
<div class="panel panel-default">
<div class="panel-body quizArea">
</div>
</div>
</div>

<script type="application/json" data-for="htmlwidget-d8670fca86eea0f0c4d6">{"x":{"question":"How would we interpret the <em>Value<\/em> (-2.35) for <em>face_typedifferent<\/em>? [Select <strong>two<\/strong> correct answers.]","answers":[{"option":"As the value of <strong>face_type<\/strong> changed from 0 (actual) to 1 (different), recognition scores decrease by 2.35.","correct":true,"message":null},{"option":"The difference between group means is -2.35.","correct":true,"message":null},{"option":"As the value of <strong>face_type<\/strong> changed from 0 (actual) to 1 (different), recognition scores decrease by 2.35 of a standard deviation","correct":false,"message":"This describes the <em>standardized<\/em> B, not the <em>unstandardized<\/em>."},{"option":"Group membership explains -2.35% of the variance in recognition scores","correct":false,"message":"This is what \\(R^2\\) tells us and you can&#39;t have a negative percentage of variance explained!"}],"label":"quiz_b_ex1-1","skipStartButton":true,"perQuestionResponseAnswers":true,"perQuestionResponseMessaging":true,"preventUnanswered":true,"displayQuestionCount":false,"displayQuestionNumber":false,"disableRanking":true,"nextQuestionText":"","checkAnswerText":"Submit Answer","allowRetry":true,"randomSortAnswers":true,"json":{"info":{"name":"","main":""},"questions":[{"q":"How would we interpret the <em>Value<\/em> (-2.35) for <em>face_typedifferent<\/em>? [Select <strong>two<\/strong> correct answers.]","a":[{"option":"As the value of <strong>face_type<\/strong> changed from 0 (actual) to 1 (different), recognition scores decrease by 2.35.","correct":true,"message":null},{"option":"The difference between group means is -2.35.","correct":true,"message":null},{"option":"As the value of <strong>face_type<\/strong> changed from 0 (actual) to 1 (different), recognition scores decrease by 2.35 of a standard deviation","correct":false,"message":"This describes the <em>standardized<\/em> B, not the <em>unstandardized<\/em>."},{"option":"Group membership explains -2.35% of the variance in recognition scores","correct":false,"message":"This is what \\(R^2\\) tells us and you can&#39;t have a negative percentage of variance explained!"}],"correct":"Correct - well done!","incorrect":"Incorrect."}]}},"evals":[],"jsHooks":[]}</script>
</td>
</tr>
</table>
</div>
<p>The confidence interval for the effect of <strong>face_type</strong> tells us that (assuming that this is one of the 95% of samples that yields a confidence interval containing the population value) the true difference between recognition scores when a picture of the actual person’s face was used compared to a different face lies between -4.596 and -0.104. This means it could be anything between a very small effect (practically zero) to a fairly large one (4 to 5 fewer faces recognised). The <em>p</em>-value suggests that this difference is significant at <em>p</em> = 0.046. In other words, we can significantly predict recognition scores from the type of face implanted while the participant met people with calcite paste on their face.</p>
<div id="section-a-more-traditional-approach" class="section level3">
<h3>A more traditional approach</h3>
<p>We have just used a hierarchical linear model to compare two means using a <em>t</em>-statistic. You have likely been taught about <em>t</em>-tests as tests in their own right, and also taught that to compare dependent means you should use the paired (dependent) <em>t</em>-test. You can do the paired <em>t</em>-test in <em>R</em> using the <code>t.test()</code> function described in <strong>adventr_15</strong>:</p>
<p><code>new_model &lt;- t.test(outcome ~ predictor, data = tibble, paired = FALSE, var.equal = FALSE, conf.level = 0.95, na.action)</code></p>
<p>In which:</p>
<ul>
<li><code>new_model</code>: an object created that contains information about the model. We can get summary statistics for this model by executing the name of the model.</li>
<li><code>outcome</code>: the variable that contains the scores for the outcome measure (in this case <strong>recognition</strong>).</li>
<li><code>predictor</code>: the variable that contains information about to which group a score belongs (in this case <strong>face_type</strong>).</li>
<li><code>tibble</code>: the name of the tibble containing the data (in this case <code>calcite_tidy</code>)</li>
<li><code>paired</code>: by default scores are treated as independent (<code>paired = FALSE</code>), but in this case we want to treat scores as dependent so we’d change this to <code>paired = TRUE</code></li>
<li><code>conf.level</code>: determines the alpha level for the <em>p</em>-value and confidence intervals. By default it is 0.95 (for 95% confidence intervals) and usually you’d exclude this option, but if you want to use a different value, say 99%, you could include <code>conf.level = 0.99</code>.</li>
<li><code>na.action</code>: If you have complete data (as we have here) exclude this option, but if you have missing values (i.e., ‘NA’s in the data frame) then it can be useful to include <code>na.action = na.exclude</code>, which will exclude all cases with missing values</li>
</ul>
<p>To get a <em>t</em>-test for the current data we would execute:</p>
<pre class="r"><code>t.test(recognition ~ face_type, data = calcite_tidy, paired = TRUE)</code></pre>
<p>or to create an object that we can use later:</p>
<pre class="r"><code>calcite_t &lt;- t.test(recognition ~ face_type, data = calcite_tidy, paired = TRUE)
calcite_t</code></pre>
<p>Try this in the code box:</p>
<div class="tutorial-exercise" data-label="t1" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="t1-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>calcite_t &lt;- t.test(recognition ~ face_type, data = calcite_tidy, paired = TRUE)
calcite_t</code></pre>
</div>
<p>The value of <em>t</em> (2.1346) and the corresponding <em>p</em> (0.04604) are identical to the linear model that we have already fitted. However, for more complicated designs the linear model has many benefits.</p>
</div>
</div>
<div id="section-robust-models" class="section level2">
<h2>Robust models</h2>
<p>The <code>WRS2</code> package <span class="citation">(Mair, Schoenbrodt, and Wilcox 2017)</span> wraps up a few of the many functions described by Wilcox to perform robust variants of tests <span class="citation">(Wilcox 2017)</span>. We’ll look at one function that compare two dependent means:</p>
<p><code>yuend(x, y, tr = 0.2)</code></p>
<p>The arguments are:</p>
<ul>
<li><code>x</code>: scores in the first condition.</li>
<li><code>y</code>: scores in the first condition.</li>
<li><code>tr = 0.2</code>: determines the level of trim. The default is a 20% trim, which has been shown to perform well, but you could change this to 0.1 (10% trim) or any value up to 0.5. You can omit this argument if you’re happy with a 20% trim.</li>
</ul>
<p>To specify <em>x</em> and <em>y</em> we need to extract them from our tibble. (I will describe one approach that is consistent with using <em>tidy</em> data, but there are others.) We would start by creating separate objects for the scores in the <em>actual</em> and <em>different</em> conditions, using <code>select()</code> and <code>filter()</code>, then insert these into the <code>yuend()</code> function:</p>
<pre class="r"><code>actual &lt;- calcite_tidy %&gt;% filter(face_type == &quot;actual&quot;) %&gt;% select(recognition)
different &lt;- calcite_tidy %&gt;% filter(face_type == &quot;different&quot;) %&gt;% select(recognition)
yuend(different, actual, tr = 0.2)</code></pre>
<p>The first line takes the <code>calcite_tidy</code> tibble and filters it to retain only the scores relating to when the variable <strong>face_type</strong> has a value equal to “actual”, it then selects the variable <strong>recognition</strong>, which contains the recognition scores. This pipe basically extracts the 20 recognition scores from the <em>actual</em> condition and stores them in a tibble called <strong>actual</strong>. The second command does the same but extracts the 20 recognition scores from the <em>different</em> condition and stores them in a tibble called <strong>different</strong>. The third lines applies the <code>yuend()</code> to the two tibbles we have just created. (You can exclude <code>tr = 0.2</code> because it is the default but I have left it there to make explicit that we are performing a 20% trim.)</p>
<p>Execute these commands in the code box (if stuck, click <img src="images/solution.png" />)</p>
<div class="tutorial-exercise" data-label="calcite_wrs" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="calcite_wrs-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>actual &lt;- calcite_tidy %&gt;% filter(face_type == &quot;actual&quot;) %&gt;% select(recognition)
different &lt;- calcite_tidy %&gt;% filter(face_type == &quot;different&quot;) %&gt;% select(recognition)
yuend(different, actual, tr = 0.2)</code></pre>
</div>
<p>Note that the trimmed mean difference is -2.75 (rather than the raw mean difference of -2.35). This difference is not significant because <em>p</em> = 0.087 and the confidence intervals cross zero, indicating that if this is one of the 95% of samples where the confidence interval contains the population value, then the population difference between means could be positive, negative or zero.</p>
<p>The effect size is a robust variant of Cohen’s <em>d</em> so can be interpreted as implanting a different face producing recognition scores 0.52 of a standard deviation below that for the actual face.</p>
</div>
<div id="section-bayesian-models" class="section level2">
<h2>Bayesian models</h2>
<div id="section-bayes-factors" class="section level3">
<h3>Bayes factors</h3>
<p>Like in <strong>adventr_15</strong> we can use the <code>ttestBF()</code> function from the <a href="http://bayesfactorpcl.r-forge.r-project.org/">BayesFactor package</a>. This function was explained in <strong>adventr_15</strong>, but with repeated measures data we can’t use formula input:</p>
<p><code>object = ttestBF(x, y, data = tibble, paired = FALSE, rscale = &quot;medium&quot;)</code></p>
<p>To recap, by default the function assumes independent scores (<code>paired = FALSE</code>) so for dependent scores we’d change this to <code>paired = TRUE</code>. The function uses default priors that can be specified as a number or as “medium” (the default), “wide”, and “ultrawide”. These labels correspond to <em>r</em> scale values of <span class="math inline">\(^\sqrt{2}/_2\)</span>, 1, and <span class="math inline">\(\sqrt{2}\)</span>. These priors were explained in <strong>adventr_11</strong>.</p>
<p>To specify <em>x</em> and <em>y</em> we can use the <strong>actual</strong> and <strong>different</strong> objects that we created for the <code>yuend()</code> function. The <code>ttextBF()</code> is expecting only scores, not a tibble or data frame and the objects <strong>actual</strong> and <strong>different</strong> are tibbles. In both objects the scores are stored in a variable called <strong>recognition</strong> so we can specify the scores as <code>different$recognition</code> and <code>actual$recognition</code>. (Remember that <code>$</code> means ‘in’, so <code>different$recognition</code> translates as ‘the variable called <em>recognition</em> in the tibble called <em>different</em>’.</p>
<p>It’s a good idea to save this model into a new object (lets call it <code>calcite_bf</code>) because you can do useful things with it (we didn’t do this for the <code>yuend()</code> functions, but you could). For our data (using the default prior) we could execute:</p>
<pre class="r"><code>calcite_bf &lt;- ttestBF(different$recognition, actual$recognition, paired = TRUE)
calcite_bf</code></pre>
<p>The first line creates the object <code>calcite_bf</code> as described above and the second line prints it for us to see. Try this in the code box:</p>
<div class="tutorial-exercise-support" data-label="calcite_bf-setup" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>actual &lt;- calcite_tidy %&gt;% filter(face_type == &quot;actual&quot;) %&gt;% select(recognition)
different &lt;- calcite_tidy %&gt;% filter(face_type == &quot;different&quot;) %&gt;% select(recognition)</code></pre>
</div>
<div class="tutorial-exercise" data-label="calcite_bf" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="calcite_bf-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>calcite_bf &lt;- ttestBF(different$recognition, actual$recognition, paired = TRUE)
calcite_bf</code></pre>
</div>
<p>The value matches that in the book (<em>an adventure in statistics</em>). The Bayes factor is 1.48, which means that the probability of the data given the alternative hypothesis is 1.48 times greater than the probability of the data given the null hypothesis. Put another way, you should shift your belief in the alternative hypothesis relative to the null by a factor of 1.48 (i.e. not by much at all). The result favours the alternative hypothesis over the null by an amount that is ‘barely worth mentioning’.</p>
</div>
<div id="section-bayesian-parameter-estimates" class="section level3">
<h3>Bayesian parameter estimates</h3>
<p>We can get estimate of the parameters in the model using the <code>posterior()</code> function that we used in <strong>adventr_15</strong> to extract the same information. The process is identical to what we did in that previous tutorial. We place the object we just created (<code>calcite_bf</code>) into the function and specify a number of iterations, then use the <code>summary()</code> function to view what we have created:</p>
<pre class="r"><code>calcite_bf_est &lt;- posterior(calcite_bf, iterations = 10000)
summary(calcite_bf_est)</code></pre>
<p>Try executing these two commands to view the estimates:</p>
<div class="tutorial-exercise-support" data-label="calcite_bf_est-setup" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>actual &lt;- calcite_tidy %&gt;% filter(face_type == &quot;actual&quot;) %&gt;% select(recognition)
different &lt;- calcite_tidy %&gt;% filter(face_type == &quot;different&quot;) %&gt;% select(recognition)
calcite_bf &lt;- ttestBF(different$recognition, actual$recognition, paired = TRUE)</code></pre>
</div>
<div class="tutorial-exercise" data-label="calcite_bf_est" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="calcite_bf_est-solution" data-caption="Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>calcite_bf_est &lt;- posterior(calcite_bf, iterations = 10000)
summary(calcite_bf_est)</code></pre>
</div>
<p>The output will differ each time you run this (because it is based on a sampling process) so Figure 2 shows my output. The Bayesian estimate, assuming that the alternative hypothesis is true, of the difference between means (mu) is -2.09. You can use the 2.5% and 97.5% quantiles as the limits of the 95% credible interval for that difference. Again, assuming the alternative hypothesis is true, there is a 95% probability that the difference between means is somewhere between -4.298 and 0.056. Remember that you cannot use a credible interval to test hypotheses because it is constructed assuming that the alternative hypothesis is true. It tells you the interval within which the effect will fall with a 95% probability, assuming that the effect exists.</p>
<div class="figure">
<img src="images/ais_15_rm_bf_est.png" alt="Figure 2: Bayesian estimates of the mask model" />
<p class="caption">Figure 2: Bayesian estimates of the mask model</p>
</div>
</div>
</div>
<div id="section-other-resources" class="section level2">
<h2>Other resources</h2>
<div id="section-statistics" class="section level3">
<h3>Statistics</h3>
<ul>
<li>The tutorials typically follow examples described in detail in <span class="citation">A. P. Field (2016)</span>, so for most of them there’s a thorough account in there. You might also find <span class="citation">A. P. Field, Miles, and Field (2012)</span> useful for the <strong>R</strong> stuff.</li>
<li>There are free lectures and screen casts on my <a href="https://www.youtube.com/user/ProfAndyField/">YouTube channel</a></li>
<li>There are free statistical resources on my website <a href="http://www.discoveringstatistics.com">www.discoveringstatistics.com</a></li>
</ul>
</div>
<div id="section-r" class="section level3">
<h3>R</h3>
<ul>
<li>Information on using <a href="http://ggplot2.tidyverse.org/">ggplot2</a></li>
<li><a href="http://r4ds.had.co.nz/index.html">R for data science</a> is the open-access version of the book by tidyverse creator Hadley Wickham <span class="citation">(Wickham and Grolemund 2017)</span>. It covers the <em>tidyverse</em> and data management.</li>
<li><a href="http://moderndive.com/index.html">ModernDive</a> is an open-access textbook on <strong>R</strong> and <strong>RStudio</strong></li>
<li><a href="https://www.rstudio.com/resources/cheatsheets/">RStudio cheat sheets</a></li>
<li><a href="https://www.rstudio.com/online-learning/">RStudio list of online resources</a></li>
<li><a href="http://swirlstats.com/students.html">SwirlStats</a> is a package for <em>R</em> that launches a bunch of interactive tutorials.</li>
</ul>
</div>
</div>
<div id="section-references" class="section level2">
<h2>References</h2>

<script type="application/shiny-prerendered" data-context="server-start">
library(forcats)
library(learnr)
library(RefManageR)
library(tidyverse)
library(BayesFactor)
library(gmodels)
library(nlme)
library(WRS2)



knitr::opts_chunk$set(echo = FALSE)
tutorial_options(exercise.cap = "Exercise")

cbBlack<-"#000000"
cbGrey<-"#999999"
cbOrange<-"#E69F00"
cbBlue<-"#56B4E9"
cbGreen<-"#009E73"
cbYellow<-"#F0E442"
cbBlueDark<-"#0072B2"
cbOrangeDark<-"#D55E00"
cbPink<-"#CC79A7"
cbRed<-"#DF4738"

andy.theme <- function(base_size = 12, base_family = "") {
  # Starts with theme_grey and then modify some parts
  theme_grey(base_size = base_size, base_family = base_family) %+replace%
    theme(
      axis.title          = element_text(size = rel(1.2)),
      axis.title.y        = element_text(margin = margin(0, 10, 0, 0), angle = 90),
      axis.title.x        = element_text(margin = margin(10, 0, 0, 0)),
      axis.text           = element_text(size = rel(0.75), colour = "grey35"),
      axis.text.x         = element_text(margin = margin(2, 0, 0, 0)),
      axis.text.y         = element_text(margin = margin(0, 2, 0, 0)),
      axis.ticks        = element_line(colour = "grey35"),
      legend.key        = element_rect(colour = "white"),
      panel.background  = element_rect(fill = "white", colour = NA),
      panel.border      = element_rect(fill = NA, colour = "grey50"),
      panel.grid.major  = element_line(colour = "grey90", size = 0.2),
      panel.grid.minor  = element_line(colour = "grey98", size = 0.5),
      strip.background  = element_rect(fill = "grey80", colour = "grey50"),
      strip.text  = element_text(size = rel(1.4))
    )
}

andy.dsus <- function(base_size = 12, base_family = "") {
  andy.theme(base_size = base_size, base_family = base_family) %+replace%
    theme(
      axis.title          = element_text(size = rel(1.6)),
      axis.text           = element_text(size = rel(1.3), colour = "grey35"),
      strip.background = element_rect(fill = cbBlueDark, colour = "white"),
      strip.text  = element_text(size = rel(1.3), colour = "white")
    )
}

colFmt = function(x,color){
  outputFormat = knitr::opts_knit$get("rmarkdown.pandoc.to")
  if(outputFormat == 'latex')
    paste("\\textcolor{",color,"}{",x,"}",sep="")
  else if(outputFormat == 'html')
    paste("<font color='",color,"'>",x,"<\u002ffont>",sep="")
  else
    x
}

#Read dat files needed for the tutorial

#If command tries to work out whether the code is running online (rather than a package). If online it loads the data from external source, otherwise it'll have the data anyway from the package

if (commandArgs()[1] == "/usr/lib/R/bin/exec/R" ){
    calcite_dat <- read_csv("http://www.discoveringstatistics.com/repository/ais_data/ais_15_calcite.csv");
    } else {
    calcite_dat <- adventr::calcite_dat
    }


#setup objects for code blocks

calcite_tidy <- calcite_dat %>% gather(key = "face_type", value = "recognition", -id)

</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-inspect_dat-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-inspect_dat-code-editor`)), session)
output$`tutorial-exercise-inspect_dat-output` <- renderUI({
  `tutorial-exercise-inspect_dat-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-gather_dat-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-gather_dat-code-editor`)), session)
output$`tutorial-exercise-gather_dat-output` <- renderUI({
  `tutorial-exercise-gather_dat-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-desc-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-desc-code-editor`)), session)
output$`tutorial-exercise-desc-output` <- renderUI({
  `tutorial-exercise-desc-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-scat-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-scat-code-editor`)), session)
output$`tutorial-exercise-scat-output` <- renderUI({
  `tutorial-exercise-scat-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-lme_1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-lme_1-code-editor`)), session)
output$`tutorial-exercise-lme_1-output` <- renderUI({
  `tutorial-exercise-lme_1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-t1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-t1-code-editor`)), session)
output$`tutorial-exercise-t1-output` <- renderUI({
  `tutorial-exercise-t1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-calcite_wrs-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-calcite_wrs-code-editor`)), session)
output$`tutorial-exercise-calcite_wrs-output` <- renderUI({
  `tutorial-exercise-calcite_wrs-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-calcite_bf-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-calcite_bf-code-editor`)), session)
output$`tutorial-exercise-calcite_bf-output` <- renderUI({
  `tutorial-exercise-calcite_bf-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-calcite_bf_est-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-calcite_bf_est-code-editor`)), session)
output$`tutorial-exercise-calcite_bf_est-output` <- renderUI({
  `tutorial-exercise-calcite_bf_est-result`()
})
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery-1.11.3"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap-3.3.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/cerulean.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css","rstudio-theme.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery-1.11.3"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["4.5.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/font-awesome-4.5.0"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/font-awesome.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["localforage"]},{"type":"character","attributes":{},"value":["1.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/localforage"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["localforage.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["0.8"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["quiz-binding"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["quiz.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery-1.11.3"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap-3.3.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["localforage"]},{"type":"character","attributes":{},"value":["1.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/localforage"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["localforage.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["slickquiz"]},{"type":"character","attributes":{},"value":["1.5.20"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/slickquiz"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/slickQuiz.js"]},{"type":"character","attributes":{},"value":["css/slickQuiz.css","css/slickQuizTutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]}]}
</script>
<!--/html_preserve-->
<div id="section-refs" class="references">
<div id="section-ref-RN10163">
<p>Field, Andy P. 2016. <em>An Adventure in Statistics: The Reality Enigma</em>. Book. London: Sage.</p>
</div>
<div id="section-ref-RN4832">
<p>Field, Andy P., Jeremy N. V. Miles, and Zoe C. Field. 2012. <em>Discovering Statistics Using R: And Sex and Drugs and Rock ’N’ Roll</em>. Book. London: Sage.</p>
</div>
<div id="section-ref-RN10205">
<p>Mair, P., F. Schoenbrodt, and Rand R. Wilcox. 2017. “WRS2: Wilcox Robust Estimation and Testing.” Journal Article. <em>R Package Version 0.9-2</em>. <a href="http://CRAN.R-project.org/package=WRS2" class="uri">http://CRAN.R-project.org/package=WRS2</a>.</p>
</div>
<div id="section-ref-RN9444">
<p>Morey, Richard D., and Jeffrey N. Rouder. 2014. “BayesFactor: Computation of Bayes Factors for Common Designs.” Journal Article R package version 0.9.9. <a href=" http://CRAN.R-project.org/package=BayesFactor">http://CRAN.R-project.org/package=BayesFactor</a>.</p>
</div>
<div id="section-ref-RN5102">
<p>Pinheiro, Jose, Douglas Bates, Saikat DebRoy, Deepayan Sarkar, and R Development Core Team. 2017. “Nlme: Linear and Nonlinear Mixed Effects Models.” Journal Article. <em>R Package Version 3.1-131</em>. <a href="http://CRAN.R-project.org/package=nlme" class="uri">http://CRAN.R-project.org/package=nlme</a>.</p>
</div>
<div id="section-ref-RN11408">
<p>Warnes, Gregory R., Ben Bolker, Thomas Lumley, and Randall C Johnson. 2015. “Gmodels: Various R Programming Tools for Model Fitting.” Journal Article. <em>R Package Version 2.16.2.</em> <a href="  https://CRAN.R-project.org/package=gmodels">https://CRAN.R-project.org/package=gmodels</a>.</p>
</div>
<div id="section-ref-RN10209">
<p>Wickham, Hadley. 2014. “Tidy Data.” Journal Article. <em>Journal of Statistical Software</em> 59 (10): 1–23. <a href="&lt;Go to ISI&gt;://WOS:000341806800001" class="uri">&lt;Go to ISI&gt;://WOS:000341806800001</a>.</p>
</div>
<div id="section-ref-RN11407">
<p>———. 2017. “Tidyverse: Easily Install and Load ’Tidyverse’ Packages.” Journal Article. <em>R Package Version 1.1.1.</em> <a href="https://CRAN.R-project.org/package=tidyverse" class="uri">https://CRAN.R-project.org/package=tidyverse</a>.</p>
</div>
<div id="section-ref-RN11404">
<p>Wickham, Hadley, and G. Grolemund. 2017. <em>R for Data Science</em>. Book. Sebastopol, CA: O’Reilly.</p>
</div>
<div id="section-ref-RN5244">
<p>Wilcox, Rand R. 2017. <em>Introduction to Robust Estimation and Hypothesis Testing</em>. Book. 4th ed. Burlington, MA: Elsevier.</p>
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="section-fn1"><p>Basically you can use this tutorial for teaching and non-profit activities but do not meddle with it or claim it as your own work.<a href="#section-fnref1">↩</a></p></li>
</ol>
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">AAiR: Repeated-measures designs</h2>
<h4 class="author"><em>Andy Field</em></h4>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>

</html>
